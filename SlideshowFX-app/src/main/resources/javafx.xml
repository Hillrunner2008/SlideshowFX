<!--
  ~ Copyright 2014 Thierry Wasylczenko
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~   http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<project name="JavaFXApplication"
         xmlns:fx="javafx:com.sun.javafx.tools.ant">
    <target name="javafxjar">

        <taskdef resource="com/sun/javafx/tools/ant/antlib.xml"
                 uri="javafx:com.sun.javafx.tools.ant"
                 classpath="${classpath}"/>

        <fx:jar destfile="${distDir}/${distName}">
            <fx:application id="application"
                            name="${applicationTitle}"
                            mainClass="${mainClassName}"
                            preloaderClass="${preloaderClassName}"
                            fallbackClass="${fallbackClassName}"/>

            <fx:platform javafx="8.0+" j2se="8.0">
                <fx:jvmarg value="-Xms512m" />
                <fx:jvmarg value="-Xmx2048" />
                <fx:jvmarg value="-Dfile.encoding=UTF-8" />
                <fx:jvmarg value="-Djavafx.preloader=com.twasyl.slideshowfx.app.SlideshowFXPreloader"/>
            </fx:platform>

            <!-- define the classpath to be placed in the manifest -->
            <fx:resources>
                <fx:fileset dir="${resourceDir}"
                            includes="${resourceIncludePattern}"
                            excludes="${resourceExcludePattern}" />
            </fx:resources>

            <manifest>
                <attribute name="Implementation-Vendor" value="${applicationVendor}"/>
                <attribute name="Implementation-Title" value="${applicationTitle}"/>
                <attribute name="Implementation-Version" value="${applicationVersion}"/>
            </manifest>

            <!-- describe the content to be packed -->
            <fileset dir="${applicationClasses}" includes="${applicationClassesIncludes}" />
            <fileset dir="${applicationResources}" includes="${applicationResourcesIncludes}" />
        </fx:jar>
    </target>

    <target name="javafxdeploy">

        <taskdef resource="com/sun/javafx/tools/ant/antlib.xml"
                 uri="javafx:com.sun.javafx.tools.ant"
                 classpath=".:${classpath}"/>

        <fx:deploy nativeBundles="all" outdir="${deployOutDir}" outfile="${distName}">
            <fx:application id="application"
                            name="${applicationTitle}"
                            mainClass="${mainClassName}"
                            preloaderClass="${preloaderClassName}"
                            fallbackClass="${fallbackClassName}"/>

            <fx:platform javafx="8.0+" j2se="8.0">
                <fx:jvmarg value="-Xms512m" />
                <fx:jvmarg value="-Xmx2048m" />
                <fx:jvmarg value="-Dfile.encoding=UTF-8" />
                <fx:jvmarg value="-Djavafx.preloader=com.twasyl.slideshowfx.app.SlideshowFXPreloader"/>
                <fx:jvmarg value="-Ddynamic.java.library.path=true"/>
            </fx:platform>

            <fx:resources>
                <fx:fileset dir="${deployResourcesDir}" />
            </fx:resources>
        </fx:deploy>
    </target>
</project>