allprojects {
	apply plugin: 'java'
	sourceCompatibility = 1.8
	targetCompatibility= 1.8
}

project(':SlideshowFX-markup') {
	
}

project(':SlideshowFX-html') {
	dependencies {
		compile project(':SlideshowFX-markup')
		compile fileTree(dir: '../lib/Felix', include: '*.jar')
	}

	jar {
		manifest {
			attributes('Manifest-Version': '1.0',
					   'Bundle-Name': 'SlideshowFX HTML support',
					   'Bundle-Description':'Support HTML for defining slide\'s content',
					   'Bundle-Version': '1.0.0',
					   'Bundle-Activator': 'com.twasyl.slideshowfx.markup.html.activator.HtmlActivator',
					   'Bundle-Vendor': 'Thierry Wasylczenko',
					   'Export-Package': 'com.twasyl.slideshowfx.markup',
					   'Import-Package': 'org.osgi.framework')
		}
	}
}

project(':SlideshowFX-markdown') {
	
	dependencies {
		compile project(':SlideshowFX-markup')
		compile fileTree(dir: '../lib/Felix', include: '*.jar')
		compile fileTree(dir: '../lib/markdown', include: '*.jar')
	}

	jar {
		from( fileTree(dir: '../lib/Felix', include: '*.jar') ) {
      		include '*'
   		}

		manifest {
			attributes('Manifest-Version': '1.0',
					   'Bundle-Name': 'SlideshowFX markdown support',
					   'Bundle-Description': 'Support markdown for defining slide\'s content',
					   'Bundle-Version': '1.0.0',
					   'Bundle-Activator': 'com.twasyl.slideshowfx.markup.markdown.activator.MarkdownActivator',
					   'Bundle-ClassPath': 'txtmark-0.11.jar,.',
					   'Bundle-Vendor': 'Thierry Wasylczenko',
					   'Export-Package': 'com.twasyl.slideshowfx.markup',
					   'Import-Package': 'org.osgi.framework')
		}
	}	
}

project(':SlideshowFX-textile') {
	
	dependencies {
		compile project(':SlideshowFX-markup')
		compile fileTree(dir: '../lib/Felix', include: '*.jar')
		compile fileTree(dir: '../lib/WikiText', include: '*.jar')
	}	

	jar {
		from( fileTree(dir: '../lib/WikiText', include: '*.jar') ) {
      		include '*'
   		}

		manifest {
			attributes('Manifest-Version': '1.0',
					   'Bundle-Name': 'SlideshowFX Textile support',
					   'Bundle-Description': 'Support Textile for defining slide\'s content',
					   'Bundle-Version': '1.0.0',
					   'Bundle-Activator': 'com.twasyl.slideshowfx.markup.textile.activator.TextileActivator',
					   'Bundle-ClassPath': 'org.eclipse.mylyn.wikitext.core_2.0.0.20140108-1934.jar,org.eclipse.mylyn.wikitext.textile.core_2.0.0.20131212-0025.jar,.',
					   'Bundle-Vendor': 'Thierry Wasylczenko',
					   'Export-Package': 'com.twasyl.slideshowfx.markup',
					   'Import-Package': 'org.osgi.framework')
		}
	}
}

project(':SlideshowFX-app') {
	apply from: '../javafx.plugin'

	dependencies {
		compile project(':SlideshowFX-markup')
		compile files('../lib/jsoup-1.7.3.jar')
		compile fileTree(dir: '../lib/Vert.x', include: '*.jar')
		compile fileTree(dir: '../lib/Felix', include: '*.jar')
		compile fileTree(dir: '../lib/ZXing', include: '*.jar')
		compile fileTree(dir: '../lib/Leap', include: '*')
		compile fileTree(dir: '../lib/Velocity', include: '*.jar')
		compile fileTree(dir: '../lib/json', include: '*.jar')
		compile fileTree(dir: '../lib/Scribe', include: '*.jar')
		testCompile files('../lib/junit-4.11.jar')
	}

	javafx {
		appID 'SlideshowFX'
		appName 'SlideshowFX'
		mainClass 'com.twasyl.slideshowfx.app.SlideshowFX'
		width 1024
		height 800
	}
}

task installMarkupPlugins << {
	
	ext.pluginsFoder = new File(projectDir, 'plugins')
	if(!ext.pluginsFoder.exists()) ext.pluginsFoder.mkdir()

	copy {
		from(new File(project(':SlideshowFX-html').libsDir, project(':SlideshowFX-html').archivesBaseName + ".jar"))
		from(new File(project(':SlideshowFX-markdown').libsDir, project(':SlideshowFX-markdown').archivesBaseName + ".jar"))
		from(new File(project(':SlideshowFX-textile').libsDir, project(':SlideshowFX-textile').archivesBaseName + ".jar"))

		into(ext.pluginsFoder)
	}
}

installMarkupPlugins.dependsOn 'SlideshowFX-html:jar'
installMarkupPlugins.dependsOn 'SlideshowFX-markdown:jar'
installMarkupPlugins.dependsOn 'SlideshowFX-textile:jar'